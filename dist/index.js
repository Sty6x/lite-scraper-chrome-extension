import Event_Signal from "./utils/pubsub.js";
import { add_field_handler, remove_field_handler, toggle_multipage_input, set_current_active_task_config, set_task_active, get_started_btn_handler, add_task, update_task_schema_input, update_website_url, init_input_buffer, save_input_buffer, eval_input_buffer, change_current_task, } from "./input_handlers.js";
import { transition_signed_in, update_json_display } from "./ui.js";
import { create_session_handler, start_session, } from "./services/server_session.js";
const sidebar = document.getElementById("sidebar");
const add_task_btn = document.getElementById("add-task");
const multipage_toggle_btn = document.getElementById("multipageToggle");
const add_field_btn = document.getElementById("add-field-btn");
const task_schema_container = document.getElementById("task-schema-container");
const get_started_btn = document.getElementById("get-started-btn");
const form = document.querySelector("form");
window.addEventListener("load", start_session);
Event_Signal.subscribe("load_existing_session", transition_signed_in);
Event_Signal.subscribe("create_session", create_session_handler, transition_signed_in);
Event_Signal.subscribe("update_sidebar_tasks_ui", set_task_active, set_current_active_task_config);
Event_Signal.subscribe("update_task_schema_input", update_task_schema_input);
Event_Signal.subscribe("update_webURL_input", update_website_url);
Event_Signal.subscribe("update_task_config_ui", update_json_display);
get_started_btn?.addEventListener("click", get_started_btn_handler);
multipage_toggle_btn?.addEventListener("click", toggle_multipage_input);
add_task_btn?.addEventListener("click", add_task);
sidebar?.addEventListener("click", change_current_task);
add_field_btn?.addEventListener("click", add_field_handler);
task_schema_container?.addEventListener("click", remove_field_handler);
form.addEventListener("focusin", init_input_buffer);
form.addEventListener("keyup", save_input_buffer);
form.addEventListener("focusout", eval_input_buffer);
